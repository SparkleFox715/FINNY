<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Report</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='ai-report-styles.css') }}">
</head>
<body class="ai-report-page">
    <div class="container">
        <h1 class="bubbly">AI-Generated Financial Report</h1>
        <div class="layout">
            <div class="switches">
                <p>Select the financial data to include:</p>
                <div class="switches-list">
                    <label>
                        <input type="checkbox" id="trailingPE" checked>
                        <span>Trailing P/E</span>
                    </label>
                    <label>
                        <input type="checkbox" id="forwardPE" checked>
                        <span>Forward P/E</span>
                    </label>
                    <label>
                        <input type="checkbox" id="trailingEPS" checked>
                        <span>Trailing EPS</span>
                    </label>
                    <label>
                        <input type="checkbox" id="forwardEPS" checked>
                        <span>Forward EPS</span>
                    </label>
                    <label>
                        <input type="checkbox" id="avgVolume" checked>
                        <span>Average Volume</span>
                    </label>
                    <label>
                        <input type="checkbox" id="volume" checked>
                        <span>Volume</span>
                    </label>
                    <label>
                        <input type="checkbox" id="bid" checked>
                        <span>Bid</span>
                    </label>
                    <label>
                        <input type="checkbox" id="ask" checked>
                        <span>Ask</span>
                    </label>
                    <label>
                        <input type="checkbox" id="open" checked>
                        <span>Open</span>
                    </label>
                    <label>
                        <input type="checkbox" id="ebitda" checked>
                        <span>EBITDA</span>
                    </label>
                    <label>
                        <input type="checkbox" id="float" checked>
                        <span>Float</span>
                    </label>
                    <label>
                        <input type="checkbox" id="sharesShort" checked>
                        <span>Shares Short</span>
                    </label>
                    <label>
                        <input type="checkbox" id="shortRatio" checked>
                        <span>Short Ratio</span>
                    </label>
                    <label>
                        <input type="checkbox" id="shortPercOfFloat" checked>
                        <span>Short Percent of Float</span>
                    </label>
                    <label>
                        <input type="checkbox" id="revenue" checked>
                        <span>Revenue</span>
                    </label>
                    <label>
                        <input type="checkbox" id="netIncome" checked>
                        <span>Net Income</span>
                    </label>
                    <label>
                        <input type="checkbox" id="profitMargin" checked>
                        <span>Profit Margin</span>
                    </label>
                    <label>
                        <input type="checkbox" id="lastFiscalYearEnd" checked>
                        <span>Last Fiscal Year End</span>
                    </label>
                    <label>
                        <input type="checkbox" id="nextFiscalYearEnd" checked>
                        <span>Next Fiscal Year End</span>
                    </label>
                    <label>
                        <input type="checkbox" id="marketCap" checked>
                        <span>Market Cap</span>
                    </label>
                    <label>
                        <input type="checkbox" id="52WeekLow" checked>
                        <span>52 Week Low</span>
                    </label>
                    <label>
                        <input type="checkbox" id="52WeekHigh" checked>
                        <span>52 Week High</span>
                    </label>
                </div>
                <div class="buttons">
                    <button onclick="generateReport()">Generate Report</button>
                    <a href="/" class="button">Home</a>
                </div>
            </div>
            <div id="reportDisplay" class="dataSection"></div>
        </div>
    </div>

    <script>
        async function generateReport() {
            const selectedOptions = {
                trailingPE: document.getElementById('trailingPE').checked,
                forwardPE: document.getElementById('forwardPE').checked,
                trailingEPS: document.getElementById('trailingEPS').checked,
                forwardEPS: document.getElementById('forwardEPS').checked,
                avgVolume: document.getElementById('avgVolume').checked,
                volume: document.getElementById('volume').checked,
                bid: document.getElementById('bid').checked,
                ask: document.getElementById('ask').checked,
                open: document.getElementById('open').checked,
                ebitda: document.getElementById('ebitda').checked,
                float: document.getElementById('float').checked,
                sharesShort: document.getElementById('sharesShort').checked,
                shortRatio: document.getElementById('shortRatio').checked,
                shortPercOfFloat: document.getElementById('shortPercOfFloat').checked,
                revenue: document.getElementById('revenue').checked,
                netIncome: document.getElementById('netIncome').checked,
                profitMargin: document.getElementById('profitMargin').checked,
                lastFiscalYearEnd: document.getElementById('lastFiscalYearEnd').checked,
                nextFiscalYearEnd: document.getElementById('nextFiscalYearEnd').checked,
                marketCap: document.getElementById('marketCap').checked,
                52WeekLow: document.getElementById('52WeekLow').checked,
                52WeekHigh: document.getElementById('52WeekHigh').checked
            };

            const response = await fetch('/generate-ai-report', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(selectedOptions)
            });

            const reportDisplay = document.getElementById('reportDisplay');
            if (response.ok) {
                const data = await response.json();
                reportDisplay.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } else {
                const error = await response.json();
                reportDisplay.textContent = `Error: ${error.error}`;
            }
        }
    </script>
</body>
</html>
